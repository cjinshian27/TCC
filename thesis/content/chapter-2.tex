%!TeX root=../tese.tex
%("dica" para o editor de texto: este arquivo é parte de um documento maior)
% para saber mais: https://tex.stackexchange.com/q/78101

\chapter{Algoritmo para MSF decremental}

\enlargethispage{.8\baselineskip}

Na literatura, existe um problema famoso que é encontrar uma árvore geradora de custo mínimo (MST, de \textit{Minimum Spanning Tree}) para um dado grafo $G$ com $n$ vértices e $m$ arestas ponderadas. Como mencionado brevemente no Capítulo~\ref{cap:introducao}, o algoritmo de Kruskal é eficiente não só na criação da árvore geradora de custo mínimo, como também na consulta de teste de conectividade. Para este último, podemos aproveitar a estrutura do Union-Find para testar se dois vértices $u$ e $v$ estão conectados em, praticamente, tempo constante.

Apesar de o algoritmo de Prim ser eficiente para criação da MST de um grafo, a estrutura de dados usada dificulta a criação de uma rotina que teste a conectividade entre dois vértices do grafo, e por isso usaremos o algoritmo de Kruskal como referência a partir de agora.

Geralmente, usamos o algoritmo de Kruskal (e o de Prim também) em grafos que não sofrem adição ou remoção de arestas com o passar do tempo, visto que queremos saber apenas o custo da MST. Sendo assim, como em Kruskal não há suporte para alterações no grafo, toda vez que removemos uma aresta temos que reconstruir a MST correspondente ao grafo novo. Pelo fato de a ordenação das $m$ arestas de $G$ consumir $\Oh(m \lg m)$ e ser a parte mais custosa do algoritmo de Kruskal, então sempre que removermos alguma aresta, o algoritmo terá que reordenar as arestas restantes e construir um novo MST para $G$.

Sendo assim, para $k$ remoções de arestas, teremos que ordenar $k$ vezes, com o custo total sendo $\Oh(m \lg m) + \Oh((m - 1) \lg (m - 1)) + \ldots + \Oh((m - k) \lg (m - k))$, pois o número de arestas vai diminuindo com as remoções. Assim, podemos expressar o custo total das remoções de cada uma das $m$ arestas no algoritmo de Kruskal pelo seguinte somatório:

\begin{equation}
    \sum_{k=1}^{m} k \lg k \approx \int_{1}^{m} x \lg x dx
    \label{first-equation}
\end{equation}
onde podemos escrever a integral como

\begin{equation}
    \int_{1}^{m} x \lg x dx = \dfrac{m^2}{2}\lg m - m^2 + \dfrac{1}{4}.
    \label{second-equation}
\end{equation}
Como o termo dominante em \ref{second-equation} é $\dfrac{m^2}{2}\lg m$, então temos que a remoção de todas as $m$ arestas possui um custo de tempo $\Oh(m^2 \lg m)$. 

Como remover arestas e ao mesmo tempo manter a MST de um grafo com as arestas restantes é ineficiente no algoritmo de Kruskal, introduziremos uma solução eficiente para este problema: o algoritmo decremental para florestas geradoras maximais de custo mínimo (MSF, de \textit{Minimum Spanning Forest}), que está descrito na Seção 4 do artigo de Holm, de Lichtenberg e Thorup~\cite{jacob_holm}.

Como o nome já sugere, o algoritmo decremental suporta apenas remoção de arestas quando se trata de alteração do grafo. A construção dele é baseada no algoritmo do grafo dinâmico apresentado na Seção~\ref{sec:dynamic-graph-creation}, com alguns ajustes extras a serem feitos. Por questões de simplicidade, abreviaremos o nome este algoritmo para \textbf{MSF decremental}, e o descreveremos em mais detalhes nas seções seguintes.

\section{Biblioteca da MSF decremental}
\label{sec:decremental-msf-library}

Implementar o algoritmo decremental para florestas geradoras maximais de custo mínimo (MSF, de \textit{Minimum Spanning Forest}) resume-se à construção da seguinte biblioteca de forma eficiente:

\begin{itemize}
    \item \texttt{\textbf{MSFDecremental(n)}}: contrói e devolve um grafo $G$ com $n$ vértices e sem arestas;
    \item \texttt{\textbf{conectadosMSF(G, u, v)}}: devolve verdadeiro se os vértices $u$ e $v$ estão na mesma componente de $G$ e falso caso contrário;
    \item \texttt{\textbf{removaMSF(G, u, v)}}: remove a aresta $uv$ do grafo $G$.
\end{itemize} 

Note que, diferente do algoritmo do grafo dinâmico, apresentado na Seção~\ref{sec:dynamic-graph-routines}, no MSF decremental não temos um método equivalente a \texttt{adicioneGD}, como mencionado no início. A versão totalmente dinâmica para florestas geradoras maximais de custo mínimo será estudada posteriormente na Seção~\ref{sec:fully-MSF}.

